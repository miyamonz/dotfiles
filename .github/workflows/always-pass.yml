# ⚠️ 一時的なテスト用ワークフロー - ブランチ保護ルールの動作確認
# このファイルはブランチ保護ルールのテスト目的で故意にワークフローを失敗させています
# 動作確認後は必ず元に戻すかこのPRをクローズしてください
#
# 動作確認用ワークフロー - 常に成功することを保証
# このワークフローはCI/CDパイプラインの動作確認やテスト用途で使用します
name: Always Pass CI

# 権限設定: 最小権限の原則に従い、リポジトリの読み取りのみを許可
permissions:
  contents: read

# トリガー設定
on:
  # すべてのブランチへのプッシュで実行
  push:
  # プルリクエストで実行
  pull_request:
  # 手動実行を許可
  workflow_dispatch:

jobs:
  ok:
    # 最新のUbuntu環境で実行
    runs-on: ubuntu-latest
    
    steps:
      # リポジトリをチェックアウト
      - name: Checkout repository
        uses: actions/checkout@v4
      
      # 環境情報を表示
      - name: Print environment info
        run: |
          echo "=== Environment Information ==="
          echo "Runner OS: $RUNNER_OS"
          echo "GitHub Event: ${{ github.event_name }}"
          echo "Branch: ${{ github.ref }}"
          echo ""
          echo "=== System Information ==="
          uname -a
          echo ""
          echo "=== Current Date/Time ==="
          date
      
      # 明示的に失敗を強制するステップ（ブランチ保護ルールのテスト用）
      - name: Force failure for protection test
        run: |
          echo "Intentionally failing for branch protection test"
          echo "ブランチ保護ルールが正しく機能しているか確認するため、故意に失敗させています"
          # 明示的に失敗コード1で終了
          exit 1
      
      # ワークフロー失敗のサマリーを出力（常に実行）
      - name: Generate success summary
        if: always()
        run: |
          echo "❌ Workflow failed (intentional for branch protection test)" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "このワークフローは、ブランチ保護ルールのテスト目的で故意に失敗させています。" >> $GITHUB_STEP_SUMMARY
          echo "動作確認が完了したら、このPRは元に戻すかクローズしてください。" >> $GITHUB_STEP_SUMMARY
